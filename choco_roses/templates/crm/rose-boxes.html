<!doctype html>
<html lang="en">
   <head>
      <!-- Required meta tags -->
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
      <title>Choco Roses</title>
      <!-- Favicon -->
      <link rel="shortcut icon" href="/static/images/favicon.ico" />
      <!-- Bootstrap CSS -->
      <link rel="stylesheet" href="/static/css/bootstrap.min.css">
      <!-- Typography CSS -->
      <link rel="stylesheet" href="/static/css/typography.css">
      <!-- Style CSS -->
      <link rel="stylesheet" href="/static/css/style.css">
      <!-- Responsive CSS -->
      <link rel="stylesheet" href="/static/css/responsive.css">
   </head>
   <body>
      <!-- loader Start -->
      <div id="loading">
         <div id="loading-center">
         </div>
      </div>
      <!-- loader END -->
      <!-- Wrapper Start -->
      <div class="wrapper"  >
      <!-- Sidebar  -->
      <div class="iq-sidebar">
            <div class="iq-sidebar-logo d-flex justify-content-between">
               <a href='/'>
               <div class="iq-light-logo">
                  <img src="/static/images/choco-logo.jpg" class="img-fluid" alt="">
               </div>
               <div class="iq-dark-logo">
                  <img src="/static/images/logo-dark.gif" class="img-fluid" alt="">
               </div>
               <span>Choco</span>
               </a>
               <div class="iq-menu-bt-sidebar">
                     <div class="iq-menu-bt align-self-center">
                        <div class="wrapper-menu">
                           <div class="main-circle"><i class="ri-arrow-left-s-line"></i></div>
                           <div class="hover-circle"><i class="ri-arrow-right-s-line"></i></div>
                        </div>
                     </div>
                  </div>
            </div>
            <div id="sidebar-scrollbar">
               <nav class="iq-sidebar-menu">
                  <ul id="iq-sidebar-toggle" class="iq-menu">
                     <li class="iq-menu-title"><i class="ri-subtract-line"></i><span>Home</span></li>
                     <li>
                        <a href="{% url 'index' %}" class="iq-waves-effect"><i class="ri-home-4-line"></i><span>Главная</span></a>
                     </li>

                     <li class="iq-menu-title"><i class="ri-subtract-line"></i><span>Apps</span></li>

                     <li><a href="{% url 'todo' %}" class="iq-waves-effect" aria-expanded="false"><i class="ri-chat-check-line"></i><span>Нужно сделать</span></a></li>
                     <li>
                        <a href="#orderinfo" class="iq-waves-effect collapsed" data-toggle="collapse" aria-expanded="false"><i class="ri-profile-line"></i><span>Заказы</span><i class="ri-arrow-right-s-line iq-arrow-right"></i></a>
                        <ul id="orderinfo" class="iq-submenu collapse" data-parent="#iq-sidebar-toggle">
                           <li><a href="{% url 'add-order' %}"><i class="ri-file-edit-line"></i>Добавить заказ</a></li>
                           <li><a href="{% url 'orders' %}"><i class="ri-file-list-line"></i>Список заказов</a></li>
                        </ul>
                     </li>
                     <li>
                        <a href="#components" class="iq-waves-effect collapsed" data-toggle="collapse" aria-expanded="false"><i class="ri-menu-2-line"></i><span>Компоненты</span><i class="ri-arrow-right-s-line iq-arrow-right"></i></a>
                        <ul id="components" class="iq-submenu collapse" data-parent="#iq-sidebar-toggle">
                           <li><a href="{% url 'boxes' %}" class="iq-waves-effect"><i class="ri-checkbox-blank-line"></i><span>Коробки</span></a></li>
                           <li><a href="{% url 'packings' %}" class="iq-waves-effect"><i class="ri-file-list-3-line"></i><span>Упаковки</span></a></li>
                           <li><a href="{% url 'products' %}" class="iq-waves-effect"><i class="ri-bank-card-line"></i><span>Продукты</span></a></li>
                        </ul>
                     </li>
                     <li><a href="{% url 'calendar' %}" class="iq-waves-effect"><i class="ri-calendar-2-line"></i><span>Календарь</span></a></li>
                     <li><a href="{% url 'settings' %}" class="iq-waves-effect"><i class="ri-settings-4-line"></i><span>Настройки</span></a></li>
                  </ul>
               </nav>
               <div class="p-3"></div>
            </div>
         </div>
      <!-- TOP Nav Bar END -->
      <!-- Responsive Breadcrumb End-->
         <!-- Page Content  -->
         <div id="content-page" class="content-page">
            <div class="container-fluid">
               <div id="row" class="row">
                   <div class="col-sm-3">
                       <div class="iq-card">
                           <div class="iq-card-header d-flex justify-content-between">
                               <div class="iq-header-title">
                                  <h4 class="card-title">Коробки</h4>
                               </div>
                           </div>
                           <div class="iq-card-body">
                               <div id="table" class="table-editable">
                                    <span class="box-add float-right mb-0 mr-2">
                                        <button class="btn btn-sm iq-bg-success"><i class="ri-add-fill">
                                            <span class="pl-1">Добавить</span></i>
                                        </button>
                                    </span>
                                   <div class="col-md-4 mb-2 float-right">
                                       <input type="text" class="form-control box-add-input" required="">
                                   </div>
                                   <table class="table mb-0 table-borderless">
                                       <thead>
                                       </thead>
                                       <tbody>
                                        <script type="text/javascript">
                                            function change() {
                                                    $('.boxes').on('blur', 'td[contenteditable]', function() {
                                                        var box_name = $(this).parents("tr").find('.box-name-label').text()
                                                        var box_id = $(this).attr('id');
                                                        var csrftoken = $( "input[name='csrfmiddlewaretoken']" ).val();

                                                        $.ajax({
                                                            data: {
                                                                'box_id': box_id,
                                                                'box_name': box_name,
                                                                'csrfmiddlewaretoken': csrftoken,
                                                                },
                                                            type: "POST",
                                                            url: "/crm/update_box/",

                                                            success: function (response) {
                                                                if (response.response) {
                                                                    console.log('Ok')
                                                                }
                                                                else {
                                                                    alert(response.error);
                                                                }
                                                            },
                                                            error: function(){
                                                                alert("Error");
                                                            }
                                                        })
                                                    });
                                            }
                                        </script>

                                        {% csrf_token %}
                                       {% for box in boxes %}


                                           <tr class="boxes">
                                               <td contenteditable="true" id="{{ box.id }}" class="box-name-label">{{ box.rose_box }}</td>
                                               <td>
                                                    <i class="ri-delete-bin-5-line text-danger box-remove"></i>
                                               </td>
                                           </tr>
                                       {% endfor %}
                                       </tbody>
                                   </table>
                               </div>
                           </div>
                       </div>
                   </div>
               </div>
            </div>
         </div>
      <!-- Wrapper END -->
      <!-- Footer -->
      <footer class="iq-footer">
         <div class="container-fluid">
            <div class="row">
               <div class="col-lg-6">
                  <ul class="list-inline mb-0">
                     <li class="list-inline-item"><a href="privacy-policy.html">Privacy Policy</a></li>
                     <li class="list-inline-item"><a href="terms-of-service.html">Terms of Use</a></li>
                  </ul>
               </div>
            </div>
         </div>
      </footer>

      <!-- Footer END -->
      <!-- Optional JavaScript -->
      <!-- jQuery first, then Popper.js, then Bootstrap JS -->
      <script src="/static/js/jquery.min.js"></script>
       <!-- Rtl and Darkmode -->
       <script src="/static/js/rtl.js"></script>
       <script src="/static/js/customizer.js"></script>
      <script src="/static/js/popper.min.js"></script>
      <script src="/static/js/bootstrap.min.js"></script>
      <!-- Appear JavaScript -->
      <script src="/static/js/jquery.appear.js"></script>
      <!-- Countdown JavaScript -->
      <script src="/static/js/countdown.min.js"></script>
      <!-- Counterup JavaScript -->
      <script src="/static/js/waypoints.min.js"></script>
      <script src="/static/js/jquery.counterup.min.js"></script>
      <!-- Wow JavaScript -->
      <script src="/static/js/wow.min.js"></script>
      <!-- Apexcharts JavaScript -->
      <script src="/static/js/apexcharts.js"></script>
      <!-- Slick JavaScript -->
      <script src="/static/js/slick.min.js"></script>
      <!-- Select2 JavaScript -->
      <script src="/static/js/select2.min.js"></script>
      <!-- Owl Carousel JavaScript -->
      <script src="/static/js/owl.carousel.min.js"></script>
      <!-- Magnific Popup JavaScript -->
      <script src="/static/js/jquery.magnific-popup.min.js"></script>
      <!-- Smooth Scrollbar JavaScript -->
      <script src="/static/js/smooth-scrollbar.js"></script>
      <!-- lottie JavaScript -->
      <script src="/static/js/lottie.js"></script>
      <!-- Chart Custom JavaScript -->
      <script src="/static/js/chart-custom.js"></script>
      <!-- Custom JavaScript -->
      <script src="/static/js/custom.js"></script>

      <!-- Custom components -->
      <script src="/static/js/components.js"></script>


   </body>
</html>